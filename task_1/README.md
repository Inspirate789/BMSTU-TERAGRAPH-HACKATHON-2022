# Проект Тераграф. Программа на основе тестового примера проекта RiscV в составе Graph Processor Core

## Индивидуальное задание
**Вариант 1**</br>
**Сетевой коммутатор на 128 портов**. Сформировать в хост-подсистеме и передать в SPE таблицу коммутации из 254 ip адресов 195.19.32.1/24 (адреса 195.19.32.1 .. 195.19.32.254). Каждому адресу поставить в соответствие один из 128 интерфейсов (целые числа 0..127). Выполнить тестирование работы коммутатора, посылая из хост-подсистемы ip адреса и сравнивая полученный от GPC номер интерфейса с ожидаемым.

## Общее описание

Тестовый проект для взаимодействия HOST систем с Graph Processor Core (XRT Runtime версия), используются аппаратные FIFO буферы по 512 слов и память External Memory.

## Установка

Для установки требуется рекурсивно клонировать репозиторий:

```bash
git clone --recursive https://github.com/Inspirate789/bmstu-teragraph-hackathon-2022.git
```

## Зависимости

Зависимости для сборки проекта:

* набор средст сборки [riscv toolchain](https://gitlab.com/quantr/toolchain/riscv-gnu-toolchain) и экспорт исполняемых файлов в `PATH`

* набор библиотек [picolib](https://github.com/picolibc/picolibc) и экспорт в `C_INCLUDE_PATH`

* исходный текст проекта [taiga](https://github.gitop.top/taiga-project/taiga) и экспорт в переменную окружения `TAIGA_DIR`

* библиотека [xrt](https://gitlab.com/xilinx4jet/XRT) и установка по пути `/opt/xilinx/xrt`

Для стандартного пользователя ВМ студенческой команды хакатона все необходимые переменные окружения установлены по-умолчанию.

## Сборка проекта

Следует выполнить команды:

```bash
cd bmstu-teragraph-hackathon-2022/
git checkout task_1
cd task_1
make
```

Результатом выполнения команды станут файлы host_main, sw_kernel_main.rawbinary и leonhard_2cores_267mhz.xclbin в директории проекта верхнего уровня.

| :exclamation:  Не забывайте синхронизировать тексты исходного текста host и kernel составляющих проекта |
|---------------------------------------------------------------------------------------------------------|

## Запуск программы

```bash
./host_main leonhard_2cores_267mhz.xclbin sw_kernel_main.rawbinary
```

## Работа программы по заданию

```bash
Input your IP: 195.19.32.1
Got IP: 195.19.32.1
Offset from the start IP: 0
Your interface: 103 (CORRECT)
```

## Если программа работает некорректно

Возможно, на вашей машине зависли другие процессы. Чтобы убить их, выполните команду

```bash
xbutil reset
```

и попробуйте запустить программу снова.

## Очистка проекта

Следует выполнить команду:

```bash
make clean
```
